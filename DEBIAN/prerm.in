#!/bin/bash

set -e

rm_ldconfig() {
  # left-hand term originates from ENABLE_LDCONFIG = ON/OFF at package build
  if [ "@ENABLE_LDCONFIG@" == "ON" ]; then
    rm -f /etc/ld.so.conf.d/x86_64-librocm_smi_lib.conf
    ldconfig
  fi
}

rm_pyc() {
 # remove pyc file generated by python
 rm -rf @CPACK_PACKAGING_INSTALL_PREFIX@/libexec/rocm_smi/__pycache__
}

case "$1" in
  ( remove | upgrade)
    rm_ldconfig
    rm_pyc
  ;;
  ( purge )
  ;;
  ( * )
    exit 0
  ;;
esac
